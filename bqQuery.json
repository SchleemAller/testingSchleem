{"query":"SELECT   SPLIT(finalPageFlow, '|') [SAFE_OFFSET(0) ],   CONCAT(    SPLIT(finalPageFlow, '|') [SAFE_OFFSET(0) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(1) ]  ),   CONCAT (    SPLIT(finalPageFlow, '|') [SAFE_OFFSET(0) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(1) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(2) ]  ),   CONCAT (    SPLIT(finalPageFlow, '|') [SAFE_OFFSET(0) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(1) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(2) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(3) ]  ),   CONCAT (    SPLIT(finalPageFlow, '|') [SAFE_OFFSET(0) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(1) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(2) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(3) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(4) ]  ),   CONCAT (    SPLIT(finalPageFlow, '|') [SAFE_OFFSET(0) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(1) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(2) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(3) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(4) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(5) ]  ),   CONCAT (    SPLIT(finalPageFlow, '|') [SAFE_OFFSET(0) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(1) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(2) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(3) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(4) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(5) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(6) ]  ),   CONCAT (    SPLIT(finalPageFlow, '|') [SAFE_OFFSET(0) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(1) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(2) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(3) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(4) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(5) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(6) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(7) ]  ),   CONCAT (    SPLIT(finalPageFlow, '|') [SAFE_OFFSET(0) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(1) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(2) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(3) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(4) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(5) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(6) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(7) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(8) ]  ),   CONCAT (    SPLIT(finalPageFlow, '|') [SAFE_OFFSET(0) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(1) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(2) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(3) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(4) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(5) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(6) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(7) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(8) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(9) ]  ),   CONCAT (    SPLIT(finalPageFlow, '|') [SAFE_OFFSET(0) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(1) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(2) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(3) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(4) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(5) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(6) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(7) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(8) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(9) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(10) ]  ),   CONCAT (    SPLIT(finalPageFlow, '|') [SAFE_OFFSET(0) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(1) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(2) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(3) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(4) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(5) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(6) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(7) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(8) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(9) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(10) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(11) ]  ),   CONCAT (    SPLIT(finalPageFlow, '|') [SAFE_OFFSET(0) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(1) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(2) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(3) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(4) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(5) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(6) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(7) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(8) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(9) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(10) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(11) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(12) ]  ),   CONCAT (    SPLIT(finalPageFlow, '|') [SAFE_OFFSET(0) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(1) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(2) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(3) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(4) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(5) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(6) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(7) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(8) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(9) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(10) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(11) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(12) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(13) ]  ),   CONCAT (    SPLIT(finalPageFlow, '|') [SAFE_OFFSET(0) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(1) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(2) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(3) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(4) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(5) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(6) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(7) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(8) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(9) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(10) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(11) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(12) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(13) ],     SPLIT(finalPageFlow, '|') [SAFE_OFFSET(14) ]  ),   countOfPageFlow,   countOfPageFlow / 2 AS countTwo FROM   (    SELECT       RTRIM(        SPLIT(newPageFlow, ';') [SAFE_OFFSET(0) ],         '|'      ) AS finalPageFlow,       countOfPageFlow     FROM       (        SELECT           pageFlow,           iso_week,           CONCAT (            pageFlow1,             '|',             IFNULL(pageFlow2, ';'),             '|',             IFNULL(pageFlow3, ';'),             '|',             IFNULL(pageFlow4, ';'),             '|',             IFNULL(pageFlow5, ';'),             '|',             IFNULL(pageFlow6, ';'),             '|',             IFNULL(pageFlow7, ';'),             '|',             IFNULL(pageFlow8, ';'),             '|',             IFNULL(pageFlow9, ';'),             '|',             IFNULL(pageFlow10, ';'),             '|',             IFNULL(pageFlow11, ';'),             '|',             IFNULL(pageFlow12, ';'),             '|',             IFNULL(pageFlow13, ';'),             '|',             IFNULL(pageFlow14, ';'),             '|'          ) AS newPageFlow,           countOfPageFlow         FROM           (            SELECT               pageFlow,               iso_week,               CONCAT (                SPLIT(pageFlow, ',') [SAFE_OFFSET(0) ],                 '1'              ) AS pageFlow1,               CONCAT (                SPLIT(pageFlow, ',') [SAFE_OFFSET(1) ],                 '2'              ) AS pageFlow2,               CONCAT (                SPLIT(pageFlow, ',') [SAFE_OFFSET(2) ],                 '3'              ) AS pageFlow3,               CONCAT (                SPLIT(pageFlow, ',') [SAFE_OFFSET(3) ],                 '4'              ) AS pageFlow4,               CONCAT (                SPLIT(pageFlow, ',') [SAFE_OFFSET(4) ],                 '5'              ) AS pageFlow5,               CONCAT (                SPLIT(pageFlow, ',') [SAFE_OFFSET(5) ],                 '6'              ) AS pageFlow6,               CONCAT (                SPLIT(pageFlow, ',') [SAFE_OFFSET(6) ],                 '7'              ) AS pageFlow7,               CONCAT (                SPLIT(pageFlow, ',') [SAFE_OFFSET(7) ],                 '8'              ) AS pageFlow8,               CONCAT (                SPLIT(pageFlow, ',') [SAFE_OFFSET(8) ],                 '9'              ) AS pageFlow9,               CONCAT (                SPLIT(pageFlow, ',') [SAFE_OFFSET(9) ],                 '10'              ) AS pageFlow10,               CONCAT (                SPLIT(pageFlow, ',') [SAFE_OFFSET(10) ],                 '11'              ) AS pageFlow11,               CONCAT (                SPLIT(pageFlow, ',') [SAFE_OFFSET(11) ],                 '12'              ) AS pageFlow12,               CONCAT (                SPLIT(pageFlow, ',') [SAFE_OFFSET(12) ],                 '13'              ) AS pageFlow13,               CONCAT (                SPLIT(pageFlow, ',') [SAFE_OFFSET(13) ],                 '14'              ) AS pageFlow14,               CONCAT (                SPLIT(pageFlow, ',') [SAFE_OFFSET(14) ],                 '15'              ) AS pageFlow15,               count(pageFlow) AS countOfPageFlow             FROM               (                SELECT                   iso_week,                   visit_id,                   STRING_AGG(                    CAST(url AS STRING),                     ','                     ORDER BY                       hitNumber                  ) AS pageFlow,                   STRING_AGG(                    CAST(hitNumber AS STRING),                     '>'                     ORDER BY                       hitNumber                  ) AS hitFlow                 FROM                   (                    SELECT                       Cast(                        Format_date(                          '%V',                           Parse_date('%Y%m%d', DATE)                        ) AS INT64                      ) AS iso_week,                       hits.page.pagePath AS url,                       CONCAT (                        CAST(fullVisitorId AS STRING),                         CAST(visitId AS STRING)                      ) AS visit_id,                       hits.hitNumber AS hitNumber,                       hits.page.hostname AS hostName                     FROM                       `analytics-platform-swe.162877134.ga_sessions_*`,                       unnest(hits) AS hits                     WHERE                       _table_suffix BETWEEN '20230101'                       AND '20230102'                       AND hits.type = 'PAGE'                       AND hits.page.hostname LIKE 'www.elle.se'                     GROUP BY                       1,                       2,                       3,                       4,                       5                  )                 GROUP BY                   1,                   2              )             WHERE               pageFlow LIKE '%mode%'             GROUP BY               1,               2,               3,               4,               5,               6,               7,               8             ORDER BY               countOfPageFlow DESC          )         GROUP BY           1,           2,           3,           4         ORDER BY           4 DESC LIMIT 100      )  )"}